# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1MopaqWhuW-IBe0pPGG6G-OphdtyXSxG7
"""

import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# 加载数据
@st.cache
def load_data():
    # 使用GitHub上的CSV文件链接或本地文件路径
    url = "https://raw.githubusercontent.com/Mhu0824/Streamlit/0cf50d29b8420dec4063fac0a9641bd68a9b28f0/movies_dataset1.csv"
    return pd.read_csv(url, encoding='ISO-8859-1')

# 数据加载
df = load_data()

# 标题
st.title("🎬 Movie Data Dashboard")

# 数据概览
st.header("Overview")
st.write("Dataset Snapshot:")
st.dataframe(df.head())

# 功能 1: 电影类型分布
st.header("Genre Distribution")

# 合并多个 genre 列，并计算出现次数
genres = pd.concat([df['genre_1'], df['genre_2'], df['genre_3']]).dropna()

# 按出现次数排序，取前15个
genre_counts = genres.value_counts(ascending=False).head(15)

# 将结果转换为 DataFrame，确保索引顺序一致
genre_counts_df = genre_counts.reset_index()
genre_counts_df.columns = ['Genre', 'Count']
genre_counts_df = genre_counts_df.sort_values(by='Count', ascending=False)

# 使用 Streamlit 的 bar_chart 按顺序绘图
st.bar_chart(genre_counts_df.set_index('Genre')['Count'])
